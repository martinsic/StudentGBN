<!doctype html>
<html lang="en">
  <head>
    <title>GBN anglickknihovna</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <!-- the common one-->
   <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
   -->
   <link rel="stylesheet" type="text/css" href="library.css">
</head>
  <style>
        .jumbotron{
            background-color:#2E2D88;
            color:white;
        }
        /* Adds borders for tabs */
        .tab-content {
            border-left: 1px solid #ddd;
            border-right: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
            padding: 10px;
        }
        .nav-tabs {
            margin-bottom: 0;
        }
        /* Sticky footer styles
-------------------------------------------------- */
html {
  position: relative;
  min-height: 100%;
}
body {
  /* Margin bottom by footer height */
  //margin-bottom: 60px;
  //min-height: 75rem;
}
.footer {
  position: absolute;
  bottom: 0;
  width: 100%;
  /* Set the fixed height of the footer here */
  height: 60px;
  line-height: 60px; /* Vertically center the text there */
  background-color: #f5f5f5;
}


/* Custom page CSS
-------------------------------------------------- */
/* Not required for template or sticky footer method. */

.container {
  width: auto;
  max-width: 680px;
  padding: 0 15px;
}

  </style>
  <body>
        <!-- .navbar-fixed-top, or .navbar-fixed-bottom can be added to keep the nav bar fixed on the screen -->
<nav class="navbar navbar-default">
        <div class="container-fluid">
      
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
      
            <!-- Button that toggles the navbar on and off on small screens -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      
            <!-- Hides information from screen readers -->
              <span class="sr-only"></span>
      
              <!-- Draws 3 bars in navbar button when in small mode -->
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
      
            <!-- You'll have to add padding in your image on the top and right of a few pixels (CSS Styling will break the navbar) -->
            <a class="pull-left" href="#"><img src="NTTLogosm.png" alt="GBN"></a>
          </div>
      
          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
              <li class="active"><a href="#">Library <span class="sr-only">(current)</span></a></li></ul>
          <ul class="nav navbar-nav navbar-right"  ><li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Log In<span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="#">Username</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="#">Passwort</a></li>
                </ul>
              </li>
          </ul>
            <!-- navbar-left will move the search to the left -->
          </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
      </nav>
           









  <br>
<br>
<br>
<div class="container">
<div align="center"> 
    <h1>English library</h1>
    <br>
    <br>
    <br>
    <br>
    <button>List of books</button></div>
</div>

<br>







    
    
<footer class="footer">
    <div class="container">
        <span class="text-muted">Opening hours Mo-Fr -> 8:00 - 10:00 &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp   Terms of usage  &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Where to find us</span>
    </div>
</footer>
    <!-- Optional JavaScript -->

 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
   <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
   --></body>
</html>

















<?php
include_once "check.php";
include_once "knihovna.php";
?>
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Homepage - GBN English Library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style3.css">
    <link rel="stylesheet" href="library.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  </head>
  <body class="Site">
    <main class="Site-content">
	 <nav class="navbar navbar-toggleable-md col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> 
   	  <a  href="http://knihovna.studentgbn.cz/index.php"><img src="GBN_Lib.png" alt="GBN" class="mainbtn"></a>
  	  <button type="button" data-toggle="modal" data-target="#addModal2" data-whatever="@getbootclass=" class="btn log navbar-toggler-right">Log in</button>
	 </nav>
      <section class="jumbotron text-center" style="background: transparent !important">
        <div class="container">
          <h1 class="jumbotron-heading">List of Books</h1>
          <p class="lead text-muted">GBN English Library</p>
        </div>
      </section>
      <div class=search>
        <form class="form-inline md-form form-sm active-purple active-purple-2 mt-2">
          <i class="fa fa-search" aria-hidden="true"></i>
          <input class="form-control form-control-sm ml-3 w-75" type="text" placeholder="Search" aria-label="Search">
        </form>
      </div>
      <div class="container">
        <div class="clearfix"></div>
        <div class="row" style="margin: 0 auto;">
<?php
if(isset($infofc["admin"]) && $infofc["admin"] == 1){
?>
          <div class="book">
            <button class="addbtn button" style="width: 100%;, height: 100%;" data-toggle="modal" data-target="#addModal">
              <div class="card" style="height: 100%;">
                <div class="wraper">
                  <div class="card-body">
                    <div class="float-left">
                      <i class="fas fa-plus fa-3x"></i>
                    </div>
                    <div class="float-right">
                      <h1>Add <br>a Book</h1>
                    </div>
                  </div>
                </div>
              </div>
            </button>
          </div>
<?php
}
booklist();
?>
        </div>    
        <div class="modal fade" id="addModal2" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addModalLabel">Log In</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <form action="loginverify.php" method="post">
                  <label>E-mail address (*works only with ...@gbn.cz*)</label>
                  <div class="inputWithIcon">
                    <input name="username" class="loginp" type="text" placeholder="E-Mail" required>
                    <i class="fas fa-id-badge fasize fa-fw" aria-hidden="true"></i>
                  </div>
                  <label>Password</label>
                  <div class="inputWithIcon">
                    <input name="password" class="loginp" type="password" placeholder="Password" required>
                    <i class="fas fa-user-shield fasize fa-fw" aria-hidden="true"></i>
                  </div>
                  <button class="btn btn-primary"></button>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Log in</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      
<div class="modal fade" id="addModal">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addModalLabel">Add Book</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <!-- NAME -->
              <div class="form-group row">
                <label for="inputName" class="col-sm-2 col-form-label">Name:</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="inputName" placeholder="Name" size="150" name="name" required>
                </div>
              </div>
              <!-- AUTHOR -->
              <div class="form-group row">
                <label for="inputAuthor" class="col-sm-2 col-form-label">Author:</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="inputAuthor" placeholder="Author" size="150" name="author" required>
                </div>
              </div>
              <!-- IBSN -->
              <div class="form-group row">
                <label for="inputIBSN" class="col-sm-2 col-form-label">IBSN:</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control noarrows" id="inputIBSN" placeholder="IBSN" name="ibsn">
                </div>
              </div>
              <!-- NUMPG -->
              <div class="form-group row">
                <label for="inputNumpg" class="col-sm-2 col-form-label">Numpg:</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control noarrows" id="inputNumpg" placeholder="Numpg" name="numpg">
                </div>
              </div>
              <!-- PUBYEAR -->
              <div class="form-group row">
                <label for="inputPubyear" class="col-sm-2 col-form-label">Pubyear:</label>
                <div class="col-sm-10">
                  <input type="date" class="form-control" id="inputPubyear" placeholder="Pubyear" name="pubyear">
                </div>
              </div>
              <!-- PUBLISHER -->
              <div class="form-group row">
                <label for="inputPublisher" class="col-sm-2 col-form-label">Publisher:</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" id="inputPublisher" placeholder="Publisher" name="publisher">
                </div>
              </div>
              <!-- LEVEL -->
              <div class="form-group row">
                <label for="inputLevel" class="col-sm-2 col-form-label">Level:</label>
                <div class="col-sm-10">
                  <select class="form-control" id="inputGenre" name="level" required>
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                  </select>
                </div>
              </div>
              <!-- TOPIC -->
              <div class="form-group row">
                <label for="inputTopic" class="col-sm-2 col-form-label">Topic:</label>
                <div class="col-sm-10">
                  <select class="form-control" id="inputTopic" name="level">
                    <option value="1">Other</option>
                    <option value="2">Fasion</option>
                    <option value="3">North America</option>
                    <option value="4">Great Britain</option>
                    <option value="5">Technology</option>
                    <option value="6">United Kingdom</option>
                  </select>
                </div>
              </div>
              <!-- EDITION -->
              <div class="form-group row">
                <label for="inputEdition" class="col-sm-2 col-form-label">Edition:</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control noarrows" id="inputEdition" placeholder="Edition" name="edition">
                </div>
              </div>
              <!-- GENRE -->
              <div class="form-group row">
                <label for="inputGenre1" class="col-sm-2 col-form-label">Genre:</label>
                <div class="col-sm-10">
                  <select class="form-control" id="inputGenre1" name="genre">
                    <option value="1">Other</option>
                    <option value="2">Fantasy</option>
                    <option value="3">Drama</option>
                    <option value="4">Mystery</option>
                    <option value="5">Romance</option>
                  </select>
                </div>
              </div>
              <!-- ANOTATION -->
              <div class="form-group">
                <label for="inputAnotation" class="col-form-label">Anotation:</label>
                <textarea class="form-control" id="inputAnotation" name="anotation"></textarea>
              </div>
              <!-- NOTES -->
              <div class="form-group">
                <label for="inputNotes" class="col-form-label">Notes:</label>
                <textarea class="form-control" id="inputNotes" name="notes"></textarea>
              </div>
              <!-- TYPE -->
              <div class="form-group row">
                <label for="inputType" class="col-sm-2 col-form-label">Type:</label>
                <div class="col-sm-10">
                  <select class="form-control" id="inputType" name="type">
                    <option value="1">Book</option>
                    <option value="2">Magazine</option>
                    <option value="3">DVD</option>
                    <option value="4">CD</option>
                    <option value="5">Tape</option>
                  </select>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
      
            <button type="button" class="btn btn-primary">Add Book</button>
          </div>
        </div>
      </div>
    </div>


    <!-- DELETE -->
    <div class="modal" tabindex="-1" role="dialog" id="del_modal">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Delete Book?</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to delete this book?</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>

            <form action="" method="POST">
              <input class="btn btn-danger" type="submit" value="Yes">
            </form>
          </div>
        </div>
      </div>
    </div>
</main>
<footer class="mt-5">
  <div class="container-fluid foo">
    <div class="row">
    <div class="col-5 col-sm-5 col-md-5 col-lg-2 col-xl-2 foo-head">Opening hours:</div>
    <div class="col-5 col-sm-5 col-md-5 col-lg-4 col-xl-4 foo-desp">Monday-Wednesday: 8:20-8:40, 9:20-9:40 <br>Thursday: Closed<br>Friday: 12:00-12:10</div><br>
    <div class="col-5 col-sm-5 col-md-5 col-lg-2 col-xl-2 foo-head">Libraries' locations:</span></div>
    <div class="col-5 col-sm-5 col-md-5 col-lg-4 col-xl-4 foo-desp">Everywhere and Nowhere, LITERALLY<br>-maybe somewhere under the shelf
    </div><br>
    </div>
  </div>
  <div class="container-fluid foot">
  <div class="row">
  <div class="col-4 col-sm-4 col-md-4 col-lg-4 col-xl-4"></div>
    <div class="col-4 col-sm-4 col-md-4 col-lg-4 col-xl-4 align-middle" data-toggle="modal2" data-target="#addModal2" data-whatever="@getbootclass=">Terms of usage</div>
  <div class="col-4 col-sm-4 col-md-4 col-lg-4 col-xl-4" data-toggle="modal" data-target="#addModal3" data-whatever="@getbootclass=">Made by: Code Week Team 2018/Q4</div>
  </div>
  </div>
</footer>

<script defer src="https://use.fontawesome.com/releases/v5.4.1/js/all.js" integrity="sha384-L469/ELG4Bg9sDQbl0hvjMq8pOcqFgkSpwhwnslzvVVGpDjYJ6wJJyYjvG3u8XW7" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</body>
</html>
































<?php
function bookdetail($idk){
	foreach($GLOBALS as $name => $value) global $$name;
	$sql = "SELECT knih_knihy.id,knih_knihy.name,knih_knihy.author,knih_knihy.isbn,knih_knihy.numpg,knih_knihy.pubyear,knih_knihy.publisher,knih_knihy.level,knih_knihy.topic,knih_knihy.edition,knih_knihy.genre,knih_knihy.anotation,knih_knihy.notes,knih_knihy.type,knih_knihy.removed,knih_vypujcky.id as vypid,knih_vypujcky.id_kniha,knih_vypujcky.email_uzivatel,knih_vypujcky.id_knihovna,knih_vypujcky.datum_vypujcky,knih_vypujcky.bor_months,knih_vypujcky.datum_vraceni,knih_vypujcky.vypujcil FROM knih_knihy LEFT JOIN knih_vypujcky ON knih_vypujcky.id_kniha=knih_knihy.id AND knih_vypujcky.datum_vraceni='0000-00-00' WHERE knih_knihy.id='" . $idk . "'";
	$result = mysqli_query($link,$sql);
	if(mysqli_affected_rows($link) == 1){
		$q = mysqli_fetch_assoc($result);
		if($q["level"] >= 7 && $infofc["admin"] != "1"){
			$dberror = "You don't have permission to view this book!";
			return $dberror;
		}elseif($q["removed"] == "1"){
			$dberror = "This book was deleted!";
			return $dberror;
		}else{
			$GLOBALS["q"] = $q;
		}
		//vypis detailu jedne vybrane knihy
	}else{
		$dberror = $l_k_notfound;
		return $dberror;
	}
}
function booklist(){
	foreach($GLOBALS as $name => $value) global $$name;
	$sql = "SELECT * FROM knih_knihy WHERE knih_knihy.level < 7 AND knih_knihy.removed=0";
    $result = mysqli_query($link,$sql);
	$pocet = mysqli_num_rows($result);
	$nastranku = 30;
	if(isset($infofc) && $infofc["admin"] == 1){
		$nastranku = 29;
	}
	if (isset($_GET['page']) && is_numeric($_GET['page']) && $_GET['page'] != "" && $_GET['page'] > 0){
		$page = round($_GET['page']);
	}else{
	$page = 1;
	}
	$existstrana = ceil($pocet/$nastranku);
	if($existstrana < $page){
		$strana = $existstrana;
	}else{
		$strana = $page;
	}
	$pmin = $strana * $nastranku - $nastranku;
	if($strana > 1){
		$predchozi = $strana - 1;
	}else{
		$predchozi = 0;
	}
	if($existstrana > $strana && $existstrana > 1){
		$dalsi = $strana + 1;
	}else{
		$dalsi = 0;
	}
	$sql = "SELECT knih_knihy.id as kid,knih_knihy.name,knih_knihy.author,knih_knihy.level,knih_vypujcky.id as vid,knih_vypujcky.email_uzivatel as email,knih_vypujcky.datum_vypujcky as datumvyp,knih_vypujcky.bor_months as vypdoba,0 as res FROM knih_knihy LEFT JOIN knih_vypujcky ON knih_knihy.id=knih_vypujcky.id_kniha AND knih_vypujcky.datum_vraceni='0000-00-00' WHERE knih_knihy.level < 7 AND knih_knihy.removed=0 AND knih_knihy.id NOT IN (SELECT id_kniha FROM knih_rezervace WHERE knih_rezervace.id_kniha=knih_knihy.id) UNION ALL
	SELECT knih_knihy.id as kid,knih_knihy.name,knih_knihy.author,knih_knihy.level,knih_vypujcky.id as vid,knih_vypujcky.email_uzivatel as email,knih_vypujcky.datum_vypujcky as datumvyp,knih_vypujcky.bor_months as vypdoba,COUNT(*) as res FROM knih_knihy LEFT JOIN knih_vypujcky ON knih_knihy.id=knih_vypujcky.id_kniha AND knih_vypujcky.datum_vraceni='0000-00-00', knih_rezervace WHERE knih_knihy.level < 7 AND knih_knihy.removed=0 AND knih_rezervace.id_kniha=knih_knihy.id ORDER BY name ASC LIMIT " . $pmin . "," . $nastranku;
	$result = mysqli_query($link,$sql);
    if(mysqli_affected_rows($link) >= 1){
		$subresult = mysqli_query($link,"SELECT * FROM knih_rezervace WHERE email_uzivatel='" . $infofc["email"] . "'");
		if(mysqli_affected_rows($link) >= 1){
			$e = 0;
			while($d = mysqli_fetch_assoc($subresult)){
				$myres[$e] = $d["id_kniha"];
				$e++;
			}
		}else{
			$myres = "";
		}
        while($q = mysqli_fetch_assoc($result)){
			echo '
			<div class="book">
            <div class="card">
              <div class="wraper">
                <div class="btn-group float-right buttons" role="group">';
			if(isset($infofc["admin"]) && $infofc["admin"] == 1){
				echo '
                  <button type="button" class="button edit" ><i class="fas fa-edit"></i></button>
                  <button type="button" class="button delete" name="button" data-toggle="modal" data-target="#del_modal"><i class="far fa-times-circle"></i></button>
				 ';
			}
			echo '
                </div>
                <div class="card-body">
                  <div>
                    <a href="bookdetail.php?id=' . $q["kid"] . '" class="title-link"><div class="twolines"><h3 class="title-ln">' . $q["name"] . '</h3></div></a>
                    <small>Written By ' . $q["author"] . '</small>
                  </div>
                  <div class="float: left;">
                    <p>Level: ' . $q["level"] . '</p>
                  </div>
				  <div class="float-right">
				  ';
				if(isset($infofc)){
				  if($q["vid"] != NULL && $q["res"] >= 3){
					  $button = '<a href="#" class="btn float-right btn-danger"><strong>Unavailable</strong></a>';
				  }
				  if(($q["vid"] != NULL) or ($q["res"] < 3 && $q["res"] >= 1)){
					  $button = '<a href="#" class="btn float-right btn-warning" style="color: white;"><strong>Reserve</strong></a>';
				  }
				  if($q["vid"] == NULL && $q["res"] == 0){
					  $button = '<a href="#" class="btn float-right btn-success"><strong>Book</strong></a>';
				  }
				  if($q["email"] == $infofc["email"] && isset($infofc)){
					  $button = '<a href="#" class="btn float-right btn-info"><strong>Borrowed</strong></a>';
				  }
				  if($myres != "" && isset($infofc)){
				  	foreach($myres as $c){
					  	if($c == $q["kid"]){
						  	$button = '<a href="#" class="btn float-right yellow"><strong>Waiting</strong></a>';
					  	}
					  }
					}
				  echo $button;
				}
			echo '
                  </div>
                </div>
              </div>
            </div>
		  </div>
		  ';
		}
		echo '
		<nav aria-label="Pagination" style="width: 100%;">
			<ul class="pagination mt-5" style="justify-content: center;">
		';
		if($existstrana > 1){
			if($page > 1){
				echo '<li class="page-item"><a class="page-link" href="?page=' . $predchozi . '">Previous</a></li>';
			}
			for($i = 1; $i <= $existstrana; $i++){
				echo '<li class="page-item"><a class="page-link" href="?page=' . $i . '">' . $i . '</a></li>';
			}
			if($page < $existstrana){
				echo '<li class="page-item"><a class="page-link" href="?page=' . $dalsi . '">Next</a></li>';
			}
		}
		echo '
            </ul>
		  </nav>
		  ';
    }else{
        return $dberror = $l_d_nomatch;
    }
}
function getreservations(){
	foreach($GLOBALS as $name => $value) global $$name;
	if($infofc["admin"] == "1"){
		$sql = "SELECT knih_knihy.id as kid,knih_knihy.name,knih_knihy.author,knih_knihy.type,knih_rezervace.id as rid,knih_rezervace.datefrom,knih_rezervace.email_uzivatel,knih_uziv.id as uid FROM knih_rezervace LEFT JOIN knih_knihy ON knih_rezervace.id_kniha=knih_knihy.id LEFT JOIN knih_uziv ON knih_uziv.email=knih_rezervace.email_uzivatel ORDER BY knih_rezervace.email_uzivatel";
	}else{
		$sql = "SELECT knih_knihy.id as kid,knih_knihy.name,knih_knihy.author,knih_knihy.type,knih_rezervace.id as rid,knih_rezervace.datefrom,knih_rezervace.email_uzivatel FROM knih_rezervace LEFT JOIN knih_knihy ON knih_rezervace.id_kniha=knih_knihy.id WHERE knih_rezervace.email_uzivatel='" . $infofc["email"] . "'";
	}
	$sql = "SELECT * FROM knih_rezervace WHERE ";
}
function getborrowings(){
	foreach($GLOBALS as $name => $value) global $$name;
	if($infofc["admin"] == "1"){
		$sql = "";
	}else{
		$sql = "";
	}
}
function reservation($idk,$email){
	foreach($GLOBALS as $name => $value) global $$name;
	$sql = "SELECT * FROM knih_rezervace WHERE id_kniha='" . $idk . "'";
	$result = mysqli_query($link,$sql);
	if(mysqli_affected_rows($result) >= 3){
		$dberror = $l_r_limit;
		return $dberror;
	}else{
		if(mysqli_affected_rows($link) != 0){
			while($q = mysqli_fetch_assoc($result)){
				if($q["email_uzivatel"] == $email){
					$dbreserr = "KO";
				}
			}
		}
		if(mysqli_affected_rows($link) == 0 or $dbreserr != "KO"){
			//dokoncit a provest SQL prikaz s overenim, zda se provedl/neprovedl - dberror
			$sql = "INSERT";
		}else{
			$dberror = $l_r_reserved;
			return $dberror;
		}
	}
}
function borrow($idk,$email){
	foreach($GLOBALS as $name => $value) global $$name;
	$sql = "";
	$result = mysqli_query($link,$sql);
	if(mysqli_affected_rows())
	$sql = "SELECT knih_knihy.id as kid,knih_vypujcky.id_kniha as idk,knih_vypujcky.email_uzivatel as emailuz FROM knih_knihy LEFT JOIN knih_vypujcky ON knih_knihy.id=knih_vypujcky.id_kniha WHERE id='" . $idk . "'";
	$q = mysqli_fetch_assoc($result);
	if($q["kid"] == $q["idk"]){
		if($q["emailuz"] == $email){
			$sql = "DELETE knih_rezervace WHERE id=" . $q["kid"];
			//jiz rezervovana uzivatelem
		}
	}else{
		//SOMETHING WILL BE HERE
	}
}
function newbook(){
	foreach($GLOBALS as $name => $value) global $$name;
	if(!isset($_POST["copies"]) or $_POST["copies"] == "" or !is_numeric($_POST["copies"])){
		$nberror["copies"] = "";
	}
	if(!isset($_POST["name"]) or $_POST["name"] == "" or preg_match("/^[a-žA-Ž0-9 ]+$/", $_POST["name"]) !== 1){
		$nberror["name"] = "";
	}
	if($_POST["author"] != "" && preg_match("/^[a-žA-Ž0-9 ]+$/", $_POST["author"]) !== 1){
		$nberror["author"] = "";
	}
	if($_POST["isbn"] != "" && !is_numeric($_POST["isbn"])){
		$nberror["isbn"] = "";
	}
	if($_POST["numpg"] != "" && !is_numeric($_POST["numpg"])){
		$nberror["numpg"] = "";
	}
	if($_POST["pubyear"] != "" && !is_numeric($_POST["pubyear"])){
		$nberror["pubyear"] = "";
	}
	if($_POST["publisher"] != "" &&  preg_match("/^[a-žA-Ž0-9 ]+$/", $_POST["publisher"]) !== 1){
		$nberror["publisher"] = "";
	}
	if(!isset($_POST["level"]) or $_POST["level"] == "" or !is_numeric($_POST["level"])){
		$nberror["level"] = "";
	}
	if($_POST["topic"] != "" && !is_numeric($_POST["topic"])){
		$nberror["topic"] = "";
	}
	if($_POST["edition"] != "" && !is_numeric($_POST["edition"])){
		$nberror["edition"] = "";
	}
	if($_POST["genre"] != "" &&  !is_numeric($_POST["genre"])){
		$nberror["genre"] = "";
	}
	if(!isset($nberror)){
		$result = mysqli_query($spojeni,"INSERT INTO knih_knihy (name,author,isbn,numpg,pubyear,publisher,level,topic,edition,genre,anotation,notes,type,removed) VALUES ('" . $_POST["name"] . "','" . $_POST["author"] . "','" . $_POST["isbn"] . "','" . $_POST["numpg"] . "','" . $_POST["pubyear"] . "','" . $_POST["publisher"] . "','" . $_POST["level"] . "','" . $_POST["topic"] . "','" . $_POST["edition"] . "','" . $_POST["genre"] . "','" . $_POST["anotation"] . "','" . $_POST["notes"] . "','" . $_POST["type"] . "','" . $_POST["removed"] . "')");
		if(mysqli_affected_rows($link) == 1){
			$response = $l_nb_ok;
			return $response;
		}else{
			$dberror = $l_nb_failed;
			return $dberror;
		}
	}
}
function editbook($id){
	if(is_numeric($id)){
		foreach($GLOBALS as $name => $value) global $$name;
		if(!isset($_POST["copies"]) or $_POST["copies"] == "" or !is_numeric($_POST["copies"])){
			$nberror["copies"] = "";
		}
		if(!isset($_POST["name"]) or $_POST["name"] == "" or preg_match("/^[a-žA-Ž0-9 ]+$/", $_POST["name"]) !== 1){
			$nberror["name"] = "";
		}
		if($_POST["author"] != "" && preg_match("/^[a-žA-Ž0-9 ]+$/", $_POST["author"]) !== 1){
			$nberror["author"] = "";
		}
		if($_POST["isbn"] != "" && !is_numeric($_POST["isbn"])){
			$nberror["isbn"] = "";
		}
		if($_POST["numpg"] != "" && !is_numeric($_POST["numpg"])){
			$nberror["numpg"] = "";
		}
		if($_POST["pubyear"] != "" && !is_numeric($_POST["pubyear"])){
			$nberror["pubyear"] = "";
		}
		if($_POST["publisher"] != "" &&  preg_match("/^[a-žA-Ž0-9 ]+$/", $_POST["publisher"]) !== 1){
			$nberror["publisher"] = "";
		}
		if(!isset($_POST["level"]) or $_POST["level"] == "" or !is_numeric($_POST["level"])){
			$nberror["level"] = "";
		}
		if($_POST["topic"] != "" && !is_numeric($_POST["topic"])){
			$nberror["topic"] = "";
		}
		if($_POST["edition"] != "" && !is_numeric($_POST["edition"])){
			$nberror["edition"] = "";
		}
		if($_POST["genre"] != "" &&  !is_numeric($_POST["genre"])){
			$nberror["genre"] = "";
		}
		if(!isset($nberror)){
			$result = mysqli_query($spojeni,"UPDATE knih_knihy SET name='" . $_POST["name"] . "',author='" . $_POST["author"] . "',isbn='" . $_POST["isbn"] . "',numpg='" . $_POST["numpg"] . "',pubyear='" . $_POST["pubyear"] . "',publisher='" . $_POST["publisher"] . "',level='" . $_POST["level"] . "',topic='" . $_POST["topic"] . "',edition='" . $_POST["edition"] . "',genre='" . $_POST["genre"] . "',anotation='" . $_POST["anotation"] . "',notes='" . $_POST["notes"] . "',type='" . $_POST["type"] . "' WHERE id='" . $id . "'");
			if(mysqli_affected_rows($link) == 1){
				$response = $l_nb_ok;
				return $response;
			}else{
				$dberror = $l_nb_failed;
				return $dberror;
			}
		}
	}else{
		$dberror = "ID of Book must be numeric!";
		return $dberror;
	}
}
function deletebook($id){
	if(is_numeric($id)){
		$result = mysqli_query($spojeni,"UPDATE knih_knihy SET removed='1' WHERE id='" . $id . "'");
	}else{
		$dberror = "ID of Book must be numeric!";
	}
}
?>
